(This page is a work in progress and is due for a revamp shortly)

h1. What is Bondi?

Bondi is a synchronus server side javascript language with extra sauce. That extra sauce is a bunch of C libraries bolted in and exposed as native js code.

Bondi contains a super fast templating engine called avalon.


h1. Object Model

h2. Intrinsic Objects (no need to instantiate)

[[Application]]
[[Request]]
[[Response]]
[[Server]]
[[File]]
[[DNS]]
[[DbParameters]]
[[Crypto]]
[[Base64]]
[[UUID]]
[[Geography]]
[[WhoIs]]

[[Queue]]

h2. Constructable Objects

[[FastCGIClient]]
[[HttpClient]]
[[FtpClient]]
[[UrlClient]]
[[DbConnection]]
[[DbCommand]]
[[MailMessage]]
[[TemplateEngine]]
[[Image]]

h2. Command Line

* -script
* -xsendfile
* -approot
* -memlimit

h2. Environment

These environment vars need to be included within the spawn-bondi.sh script on linux to ensure they're allowed in the bondi fcgi environment. All other environment variables are wiped.
* BONDI_SCRIPT
* BONDI_STARTSCRIPT
* BONDI_XSENDFILE
* BONDI_XREWRITE
* BONDI_APPROOT
* BONDI_MEMLIMIT - NOTE: not yet implemented
* BONDI_GEOIPDB - path to maxmind city database
* BONDI_MAIL - semi colon delimited lists of mail server host:port form, mail drop path or mail command
* BONDI_SCRIPTCACHE - set to "off" to inhibit script caching

h2. Mail Handling

If you run bondi with env CONTENT_TYPE=message/rfc822, then bondi will parse the email on stdin and turn your Request.Form object into a mail object:
for multipart/ mime type parts the Body property ends up with an object with a BodyParts array and a Parent property so you can traverse around. If the multipart type is multipart/mixed there will be an Attachments array otherwise there will be an InlineAttachments array if there are mime types that don't create a TextBody or a HTMLBody(or subsequent Body with more body parts)


Example
********
<pre><code>env CONTENT_TYPE=message/rfc822 bondi mail.esp < mymailmessage
Request.Form
</code></pre>
